<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_transform_map">
    <sys_transform_map action="INSERT_OR_UPDATE">
        <active>true</active>
        <copy_empty_fields>false</copy_empty_fields>
        <create_new_record_on_empty_coalesce_fields>false</create_new_record_on_empty_coalesce_fields>
        <enforce_mandatory_fields>No</enforce_mandatory_fields>
        <name>To PALMSnow questions</name>
        <order>100</order>
        <run_business_rules>true</run_business_rules>
        <run_script>true</run_script>
        <script><![CDATA[(function transformRow(source, target, map, log, isUpdate) {

	var rx = new RegExp(/^c\d{4}/i);
	var userid = '';
	var assignTo = '';

	function getUserSysId(userName) {
		var userGr = new GlideRecord('sys_user');
		userGr.addQuery('user_name', userName);
		userGr.query();
		if (userGr.next()) {
			return userGr.getUniqueValue();
		}
	}

	function getStoreManagerSysId(storeName) {
		var userGr = new GlideRecord('sys_user');
		userGr.addQuery('department.name', storeName);
		userGr.addQuery('title', 'Store Manager');
		userGr.query();
		if (userGr.next()) {
			return userGr.getUniqueValue();
		}
	}

	if(source.u_stepid == 1) {
		if(rx.test(source.u_userid)) {
			userid = getStoreManagerSysId(source.u_userid);
		} else {
			userid = getUserSysId(source.u_userid);
		}
		target.requested_by = userid;
	}

	if(rx.test(source.u_userid)) {
		assignTo = getStoreManagerSysId(source.u_userid);
	} else {
		assignTo = getUserSysId(source.u_userid);
	}
	target.assigned_to = assignTo;

})(source, target, map, log, action==="update");]]></script>
        <source_table>x_aaro2_pnl_mgmt_questions_data_creators</source_table>
        <sys_class_name>sys_transform_map</sys_class_name>
        <sys_created_by>xxikochet</sys_created_by>
        <sys_created_on>2021-04-02 12:12:27</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>f2e727c1db5f2450f41dc15b139619c1</sys_id>
        <sys_mod_count>2</sys_mod_count>
        <sys_name>To PALMSnow questions</sys_name>
        <sys_package display_value="PALMSnow" source="x_aaro2_pnl_mgmt">58a846e1db14ec50389b84d868961919</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="PALMSnow">58a846e1db14ec50389b84d868961919</sys_scope>
        <sys_update_name>sys_transform_map_f2e727c1db5f2450f41dc15b139619c1</sys_update_name>
        <sys_updated_by>xxmpurik</sys_updated_by>
        <sys_updated_on>2021-05-20 12:23:46</sys_updated_on>
        <target_table>x_aaro2_pnl_mgmt_question</target_table>
    </sys_transform_map>
</record_update>
